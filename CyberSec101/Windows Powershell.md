#powershell #Windows 

https://tryhackme.com/r/room/windowspowershell

https://medium.com/@Z3pH7/tryhackme-windows-powershell-cyber-security-101-thm-1ce536803b8d

this one --
https://medium.com/@magesh007/windows-powershell-tryhackme-writeup-b8e1ed29c871


https://github.com/Whitecat18/Powershell-Scripts-for-Hackers-and-Pentesters


PowerShell is a powerful tool from Microsoft designed for task automation and configuration management. It combines a command-line interface and a scripting language built on the .NET framework.

PowerShell is object-oriented, which means it can handle complex data types and interact with system components more effectively.

released in 2006
2016 was Powershell Core - cross platform 

PowerShell, objects are fundamental units that encapsulate data and functionality, making it easier to manage and manipulate information. An object in PowerShell can contain file names, usernames or sizes as data (**properties**), and carry functions (**methods**) such as copying a file or stopping a process.


Powershell is not case sensitive 


remmina > ssh 
```
captain : JollyR0ger#
```


launch Powershell
- start menu > powershell
- Win + R
- file explorer  > powershell
- task manager 

Cmdlets follow a consistent `Verb-Noun` naming convention. This structure makes it easy to understand what each cmdlet does. The `Verb` describes the action, and the `Noun` specifies the object on which action is performed. For example:

- `Get-Content`: Retrieves (gets) the content of a file and displays it in the console.
- `Set-Location`: Changes (sets) the current working directory.

#### Get-Command  list

`Get-Command`

```
Cmdlet          Enable-PSRemoting                                  3.... 
Cmdlet          Enable-PSSessionConfiguration                      3.... 
Cmdlet          Enable-RunspaceDebug                               3.... 
Cmdlet          Enable-ScheduledJob                                1.... 
Cmdlet          Enable-TlsCipherSuite                              2.... 
Cmdlet          Enable-TlsEccCurve                                 2.... 
Cmdlet          Enable-TlsSessionTicketKey                         2.... 
Cmdlet          Enable-TpmAutoProvisioning                         2.... 
Cmdlet          Enable-WindowsErrorReporting                       1.0   
Cmdlet          Enable-WindowsOptionalFeature                      3.0   
Cmdlet          Enable-WSManCredSSP                                3.... 
Cmdlet          Enter-PSHostProcess                                3.... 
Cmdlet          Enter-PSSession                                    3.... 
Cmdlet          Exit-PSHostProcess                                 3.... 
Cmdlet          Exit-PSSession                                     3.... 
Cmdlet          Expand-WindowsCustomDataImage                      3.0   
Cmdlet          Expand-WindowsImage                                3.0  
Cmdlet          Export-Alias                                       3.... 
Cmdlet          Export-BinaryMiLog                                 1.... 
Cmdlet          Export-Certificate                                 1.... 
Cmdlet          Export-Clixml                                      3.... 
Cmdlet          Export-Console                                     3.... 
Cmdlet          Export-Counter                                     3.... 
Cmdlet          Export-Csv                                         3.... 
Cmdlet          Export-FormatData                                  3.... 
Cmdlet          Export-IscsiVirtualDiskSnapshot                    2.... 
Cmdlet          Export-ModuleMember                                3.... 
Cmdlet          Export-PfxCertificate                              1....
Cmdlet          Export-PSSession                                   3.... 
Cmdlet          Export-TlsSessionTicketKey                         2.... 
Cmdlet          Export-WindowsCapabilitySource                     3.0   
Cmdlet          Export-WindowsDriver                               3.0   
Cmdlet          Export-WindowsImage                                3.0   
Cmdlet          Find-LapsADExtendedRights                          1.... 
Cmdlet          Find-Package                                       1.... 
Cmdlet          Find-PackageProvider                               1.... 
Cmdlet          ForEach-Object                                     3.... 
Cmdlet          Format-Custom                                      3.... 
Cmdlet          Format-List                                        3.... 
Cmdlet          Format-SecureBootUEFI                              2.... 
Cmdlet          Format-Table                                       3.... 
Cmdlet          Format-Wide                                        3....
Cmdlet          Get-Acl                                            3.... 
Cmdlet          Get-Alias                                          3.... 
Cmdlet          Get-AppLockerFileInformation                       2.... 
Cmdlet          Get-AppLockerPolicy                                2.... 
Cmdlet          Get-AppxDefaultVolume                              2.... 
Cmdlet          Get-AppxPackage                                    2.... 
Cmdlet          Get-AppxPackageManifest                            2.... 
Cmdlet          Get-AppxProvisionedPackage                         3.0   
Cmdlet          Get-AppxVolume                                     2.... 
Cmdlet          Get-AuthenticodeSignature                          3.... 
Cmdlet          Get-BitsTransfer                                   2.... 
Cmdlet          Get-BpaModel                                       1.0  
Cmdlet          Get-BpaResult                                      1.0   
Cmdlet          Get-Certificate                                    1.... 
Cmdlet          Get-CertificateAutoEnrollmentPolicy                1.... 
Cmdlet          Get-CertificateEnrollmentPolicyServer              1.... 
Cmdlet          Get-CertificateNotificationTask                    1.... 
Cmdlet          Get-ChildItem                                      3.... 
Cmdlet          Get-CimAssociatedInstance                          1.... 
Cmdlet          Get-CimClass                                       1.... 
Cmdlet          Get-CimInstance                                    1.... 
Cmdlet          Get-CimSession                                     1.... 
Cmdlet          Get-CIPolicy                                       1.0   
Cmdlet          Get-CIPolicyIdInfo                                 1.0   
Cmdlet          Get-CIPolicyInfo                                   1.0   
Cmdlet          Get-Clipboard                                      3.... 
Cmdlet          Get-CmsMessage                                     3.... 
Cmdlet          Get-Command                                        3.... 
Cmdlet          Get-ComputerInfo                                   3....
Cmdlet          Get-ComputerRestorePoint                           3.... 
Cmdlet          Get-Content                                        3.... 
Cmdlet          Get-ControlPanelItem                               3.... 
Cmdlet          Get-Counter                                        3.... 
Cmdlet          Get-Credential                                     3.... 
Cmdlet          Get-Culture                                        3.... 
Cmdlet          Get-DAPolicyChange                                 2.... 
Cmdlet          Get-Date                                           3.... 
Cmdlet          Get-DeliveryOptimizationLog                        1.... 
Cmdlet          Get-DeliveryOptimizationLogAnalysis                1.... 
Cmdlet          Get-Event                                          3.... 
Cmdlet          Get-EventLog                                       3.... 
Cmdlet          Get-EventSubscriber                                3.... 
Cmdlet          Get-ExecutionPolicy                                3....
Cmdlet          Get-FormatData                                     3.... 
Cmdlet          Get-Help                                           3.... 
Cmdlet          Get-History                                        3.... 
Cmdlet          Get-Host                                           3.... 
Cmdlet          Get-HotFix                                         3.... 
Cmdlet          Get-IscsiServerTarget                              2.... 
Cmdlet          Get-IscsiTargetServerSetting                       2.... 
Cmdlet          Get-IscsiVirtualDisk                               2.... 
Cmdlet          Get-IscsiVirtualDiskSnapshot                       2.... 
Cmdlet          Get-Item                                           3.... 
Cmdlet          Get-ItemProperty                                   3.... 
Cmdlet          Get-ItemPropertyValue                              3.... 
Cmdlet          Get-Job                                            3.... 
Cmdlet          Get-JobTrigger                                     1.... 
Cmdlet          Get-KdsConfiguration                               1.... 
Cmdlet          Get-KdsRootKey                                     1....
Cmdlet          Get-LapsADPassword                                 1.... 
Cmdlet          Get-LocalGroup                                     1.... 
Cmdlet          Get-LocalGroupMember                               1.... 
Cmdlet          Get-LocalUser                                      1.... 
Cmdlet          Get-Location                                       3.... 
Cmdlet          Get-Member                                         3.... 
Cmdlet          Get-Module                                         3.... 
Cmdlet          Get-NfsMappedIdentity                              1.0   
Cmdlet          Get-NfsNetgroup                                    1.0   
Cmdlet          Get-NonRemovableAppsPolicy                         3.0   
Cmdlet          Get-Package                                        1.... 
Cmdlet          Get-PackageProvider                                1.... 
Cmdlet          Get-PackageSource                                  1.... 
Cmdlet          Get-PfxCertificate                                 3.... 
Cmdlet          Get-PfxData                                        1.... 
Cmdlet          Get-PmemDedicatedMemory                            1....
Cmdlet          Get-PmemDisk                                       1.... 
Cmdlet          Get-PmemPhysicalDevice                             1.... 
Cmdlet          Get-PmemUnusedRegion                               1.... 
Cmdlet          Get-Process                                        3.... 
Cmdlet          Get-ProcessMitigation                              1.... 
Cmdlet          Get-PSBreakpoint                                   3.... 
Cmdlet          Get-PSCallStack                                    3.... 
Cmdlet          Get-PSDrive                                        3.... 
Cmdlet          Get-PSHostProcessInfo                              3.... 
Cmdlet          Get-PSProvider                                     3.... 
Cmdlet          Get-PSReadLineKeyHandler                           2.0.0 
Cmdlet          Get-PSReadLineOption                               2.0.0 
Cmdlet          Get-PSSession                                      3....
Cmdlet          Get-PSSessionCapability                            3.... 
Cmdlet          Get-PSSessionConfiguration                         3.... 
Cmdlet          Get-PSSnapin                                       3.... 
Cmdlet          Get-Random                                         3.... 
Cmdlet          Get-Runspace                                       3.... 
Cmdlet          Get-RunspaceDebug                                  3.... 
Cmdlet          Get-ScheduledJob                                   1.... 
Cmdlet          Get-ScheduledJobOption                             1.... 
Cmdlet          Get-SecureBootPolicy                               2.... 
Cmdlet          Get-SecureBootUEFI                                 2.... 
Cmdlet          Get-Service                                        3.... 
Cmdlet          Get-SystemDriver                                   1.0   
Cmdlet          Get-TimeZone                                       3.... 
Cmdlet          Get-TlsCipherSuite                                 2.... 
Cmdlet          Get-TlsEccCurve                                    2.... 
Cmdlet          Get-Tpm                                            2.... 
Cmdlet          Get-TpmEndorsementKeyInfo                          2....
Cmdlet          Get-TpmSupportedFeature                            2.... 
Cmdlet          Get-TraceSource                                    3.... 
Cmdlet          Get-Transaction                                    3.... 
Cmdlet          Get-TypeData                                       3.... 
Cmdlet          Get-UICulture                                      3.... 
Cmdlet          Get-Unique                                         3.... 
Cmdlet          Get-Variable                                       3.... 
Cmdlet          Get-WheaMemoryPolicy                               2.... 
Cmdlet          Get-WIMBootEntry                                   3.0  
Cmdlet          Get-WinAcceptLanguageFromLanguageListOptOut        2.... 
Cmdlet          Get-WinCultureFromLanguageListOptOut               2.... 
Cmdlet          Get-WinDefaultInputMethodOverride                  2.... 
Cmdlet          Get-WindowsCapability                              3.0   
Cmdlet          Get-WindowsDriver                                  3.0   
Cmdlet          Get-WindowsEdition                                 3.0   
Cmdlet          Get-WindowsErrorReporting                          1.0   
Cmdlet          Get-WindowsImage                                   3.0   
Cmdlet          Get-WindowsImageContent                            3.0   
Cmdlet          Get-WindowsOptionalFeature                         3.0   
Cmdlet          Get-WindowsPackage                                 3.0   
Cmdlet          Get-WindowsReservedStorageState                    3.0   
Cmdlet          Get-WinEvent                                       3....
Cmdlet          Get-WinHomeLocation                                2.... 
Cmdlet          Get-WinLanguageBarOption                           2.... 
Cmdlet          Get-WinSystemLocale                                2.... 
Cmdlet          Get-WinUILanguageOverride                          2.... 
Cmdlet          Get-WinUserLanguageList                            2.... 
Cmdlet          Get-WmiObject                                      3.... 
Cmdlet          Get-WSManCredSSP                                   3.... 
Cmdlet          Get-WSManInstance                                  3.... 
Cmdlet          Group-Object                                       3.... 
Cmdlet          Import-Alias                                       3.... 
Cmdlet          Import-BinaryMiLog                                 1.... 
Cmdlet          Import-Certificate                                 1.... 
Cmdlet          Import-Clixml                                      3.... 
Cmdlet          Import-Counter                                     3.... 
Cmdlet          Import-Csv                                         3....
Cmdlet          Import-IscsiVirtualDisk                            2.... 
Cmdlet          Import-LocalizedData                               3.... 
Cmdlet          Import-Module                                      3.... 
Cmdlet          Import-PackageProvider                             1.... 
Cmdlet          Import-PfxCertificate                              1.... 
Cmdlet          Import-PSSession                                   3.... 
Cmdlet          Import-TpmOwnerAuth                                2.... 
Cmdlet          Initialize-PmemPhysicalDevice                      1.... 
Cmdlet          Initialize-Tpm                                     2.... 
Cmdlet          Install-NfsMappingStore                            1.0   
Cmdlet          Install-Package                                    1.... 
Cmdlet          Install-PackageProvider                            1.... 
Cmdlet          Invoke-BpaModel                                    1.0   
Cmdlet          Invoke-CimMethod                                   1.... 
Cmdlet          Invoke-Command                                     3.... 
Cmdlet          Invoke-CommandInDesktopPackage                     2.... 
Cmdlet          Invoke-DscResource                                 1.1   
Cmdlet          Invoke-Expression                                  3.... 
Cmdlet          Invoke-History                                     3.... 
Cmdlet          Invoke-Item                                        3.... 
Cmdlet          Invoke-LapsPolicyProcessing                        1.... 
Cmdlet          Invoke-RestMethod                                  3.... 
Cmdlet          Invoke-WebRequest                                  3.... 
Cmdlet          Invoke-WmiMethod                                   3.... 
Cmdlet          Invoke-WSManAction                                 3.... 
Cmdlet          Join-DtcDiagnosticResourceManager                  1.... 
Cmdlet          Join-Path                                          3.... 
Cmdlet          Limit-EventLog                                     3.... 
Cmdlet          Measure-Command                                    3.... 
Cmdlet          Measure-Object                                     3....
Cmdlet          Merge-CIPolicy                                     1.0   
Cmdlet          Mount-AppxVolume                                   2.... 
Cmdlet          Mount-IscsiVirtualDiskSnapshot                     2.... 
Cmdlet          Mount-WindowsImage                                 3.0   
Cmdlet          Move-AppxPackage                                   2.... 
Cmdlet          Move-Item                                          3.... 
Cmdlet          Move-ItemProperty                                  3.... 
Cmdlet          New-Alias                                          3.... 
Cmdlet          New-AppLockerPolicy                                2.... 
Cmdlet          New-CertificateNotificationTask                    1.... 
Cmdlet          New-CimInstance                                    1.... 
Cmdlet          New-CimSession                                     1.... 
Cmdlet          New-CimSessionOption                               1.... 
Cmdlet          New-CIPolicy                                       1.0   
Cmdlet          New-CIPolicyRule                                   1.0   
Cmdlet          New-DtcDiagnosticTransaction                       1....
Cmdlet          New-Event                                          3.... 
Cmdlet          New-EventLog                                       3.... 
Cmdlet          New-FileCatalog                                    3.... 
Cmdlet          New-IscsiServerTarget                              2.... 
Cmdlet          New-IscsiVirtualDisk                               2.... 
Cmdlet          New-Item                                           3.... 
Cmdlet          New-ItemProperty                                   3.... 
Cmdlet          New-JobTrigger                                     1.... 
Cmdlet          New-LocalGroup                                     1.... 
Cmdlet          New-LocalUser                                      1.... 
Cmdlet          New-Module                                         3.... 
Cmdlet          New-ModuleManifest                                 3.... 
Cmdlet          New-NetIPsecAuthProposal                           2.... 
Cmdlet          New-NetIPsecMainModeCryptoProposal                 2.... 
Cmdlet          New-NetIPsecQuickModeCryptoProposal                2.... 
Cmdlet          New-NfsMappedIdentity                              1.0   
Cmdlet          New-NfsNetgroup                                    1.0  
Cmdlet          New-Object                                         3.... 
Cmdlet          New-PmemDedicatedMemory                            1.... 
Cmdlet          New-PmemDisk                                       1.... 
Cmdlet          New-PSDrive                                        3.... 
Cmdlet          New-PSRoleCapabilityFile                           3.... 
Cmdlet          New-PSSession                                      3.... 
Cmdlet          New-PSSessionConfigurationFile                     3.... 
Cmdlet          New-PSSessionOption                                3.... 
Cmdlet          New-PSTransportOption                              3....
Cmdlet          New-PSWorkflowExecutionOption                      2....
Cmdlet          New-ScheduledJobOption                             1.... 
Cmdlet          New-SelfSignedCertificate                          1.... 
Cmdlet          New-Service                                        3.... 
Cmdlet          New-TimeSpan                                       3.... 
Cmdlet          New-TlsSessionTicketKey                            2.... 
Cmdlet          New-Variable                                       3.... 
Cmdlet          New-WebServiceProxy                                3.... 
Cmdlet          New-WindowsCustomImage                             3.0   
Cmdlet          New-WindowsImage                                   3.0   
Cmdlet          New-WinEvent                                       3.... 
Cmdlet          New-WinUserLanguageList                            2.... 
Cmdlet          New-WSManInstance                                  3.... 
Cmdlet          New-WSManSessionOption                             3.... 
Cmdlet          Optimize-AppxProvisionedPackages                   3.0   
Cmdlet          Optimize-WindowsImage                              3.0   
Cmdlet          Out-Default                                        3....
Cmdlet          Out-File                                           3.... 
Cmdlet          Out-GridView                                       3.... 
Cmdlet          Out-Host                                           3.... 
Cmdlet          Out-Null                                           3.... 
Cmdlet          Out-Printer                                        3.... 
Cmdlet          Out-String                                         3.... 
Cmdlet          Pop-Location                                       3.... 
Cmdlet          Protect-CmsMessage                                 3.... 
Cmdlet          Publish-DscConfiguration                           1.1   
Cmdlet          Push-Location                                      3.... 
Cmdlet          Read-Host                                          3.... 
Cmdlet          Receive-DtcDiagnosticTransaction                   1.... 
Cmdlet          Receive-Job                                        3.... 
Cmdlet          Receive-PSSession                                  3.... 
Cmdlet          Register-ArgumentCompleter                         3....
Cmdlet          Register-CimIndicationEvent                        1.... 
Cmdlet          Register-EngineEvent                               3.... 
Cmdlet          Register-ObjectEvent                               3.... 
Cmdlet          Register-PackageSource                             1.... 
Cmdlet          Register-PSSessionConfiguration                    3.... 
Cmdlet          Register-ScheduledJob                              1.... 
Cmdlet          Register-WmiEvent                                  3.... 
Cmdlet          Remove-AppxPackage                                 2.... 
Cmdlet          Remove-AppxProvisionedPackage                      3.0   
Cmdlet          Remove-AppxVolume                                  2.... 
Cmdlet          Remove-BitsTransfer                                2.... 
Cmdlet          Remove-CertificateEnrollmentPolicyServer           1.... 
Cmdlet          Remove-CertificateNotificationTask                 1.... 
Cmdlet          Remove-CimInstance                                 1.... 
Cmdlet          Remove-CimSession                                  1....
Cmdlet          Remove-CIPolicyRule                                1.0   
Cmdlet          Remove-Computer                                    3.... 
Cmdlet          Remove-Event                                       3.... 
Cmdlet          Remove-EventLog                                    3.... 
Cmdlet          Remove-IscsiServerTarget                           2.... 
Cmdlet          Remove-IscsiVirtualDisk                            2.... 
Cmdlet          Remove-IscsiVirtualDiskSnapshot                    2.... 
Cmdlet          Remove-IscsiVirtualDiskTargetMapping               2.... 
Cmdlet          Remove-Item                                        3.... 
Cmdlet          Remove-ItemProperty                                3.... 
Cmdlet          Remove-Job                                         3.... 
Cmdlet          Remove-JobTrigger                                  1.... 
Cmdlet          Remove-LocalGroup                                  1.... 
Cmdlet          Remove-LocalGroupMember                            1....
Cmdlet          Remove-LocalUser                                   1.... 
Cmdlet          Remove-Module                                      3.... 
Cmdlet          Remove-NfsMappedIdentity                           1.0   
Cmdlet          Remove-NfsNetgroup                                 1.0   
Cmdlet          Remove-PmemDedicatedMemory                         1.... 
Cmdlet          Remove-PmemDisk                                    1.... 
Cmdlet          Remove-PSBreakpoint                                3.... 
Cmdlet          Remove-PSDrive                                     3.... 
Cmdlet          Remove-PSReadLineKeyHandler                        2.0.0 
Cmdlet          Remove-PSSession                                   3.... 
Cmdlet          Remove-PSSnapin                                    3.... 
Cmdlet          Remove-TypeData                                    3.... 
Cmdlet          Remove-Variable                                    3.... 
Cmdlet          Remove-WindowsCapability                           3.0   
Cmdlet          Remove-WindowsDriver                               3.0  
Cmdlet          Remove-WindowsImage                                3.0   
Cmdlet          Remove-WindowsPackage                              3.0   
Cmdlet          Remove-WmiObject                                   3.... 
Cmdlet          Remove-WSManInstance                               3.... 
Cmdlet          Rename-Computer                                    3.... 
Cmdlet          Rename-Item                                        3.... 
Cmdlet          Rename-ItemProperty                                3.... 
Cmdlet          Rename-LocalGroup                                  1.... 
Cmdlet          Rename-LocalUser                                   1.... 
Cmdlet          Repair-WindowsImage                                3.0   
Cmdlet          Reset-AppxPackage                                  2.... 
Cmdlet          Reset-ComputerMachinePassword                      3.... 
Cmdlet          Reset-LapsPassword                                 1.... 
Cmdlet          Resize-IscsiVirtualDisk                            2.... 
Cmdlet          Resolve-DnsName                                    1.... 
Cmdlet          Resolve-Path                                       3.... 
Cmdlet          Restart-Computer                                   3.... 
Cmdlet          Restart-Service                                    3.... 
Cmdlet          Restore-AuditPolicy                                1.... 
Cmdlet          Restore-Computer                                   3.... 
Cmdlet          Restore-IscsiVirtualDisk                           2.... 
Cmdlet          Restore-SecurityPolicy                             1.... 
Cmdlet          Resume-BitsTransfer                                2.... 
Cmdlet          Resume-Job                                         3.... 
Cmdlet          Resume-Service                                     3.... 
Cmdlet          Save-Help                                          3.... 
Cmdlet          Save-Package                                       1.... 
Cmdlet          Save-WindowsImage                                  3.0   
Cmdlet          Select-Object                                      3.... 
Cmdlet          Select-String                                      3.... 
Cmdlet          Select-Xml                                         3....
Cmdlet          Send-DtcDiagnosticTransaction                      1.... 
Cmdlet          Send-MailMessage                                   3.... 
Cmdlet          Set-Acl                                            3.... 
Cmdlet          Set-Alias                                          3.... 
Cmdlet          Set-AppLockerPolicy                                2.... 
Cmdlet          Set-AppxDefaultVolume                              2.... 
Cmdlet          Set-AppXProvisionedDataFile                        3.0   
Cmdlet          Set-AuthenticodeSignature                          3.... 
Cmdlet          Set-BitsTransfer                                   2.... 
Cmdlet          Set-BpaResult                                      1.0   
Cmdlet          Set-CertificateAutoEnrollmentPolicy                1.... 
Cmdlet          Set-CimInstance                                    1.... 
Cmdlet          Set-CIPolicyIdInfo                                 1.0  
Cmdlet          Set-CIPolicySetting                                1.0   
Cmdlet          Set-CIPolicyVersion                                1.0   
Cmdlet          Set-Clipboard                                      3.... 
Cmdlet          Set-Content                                        3.... 
Cmdlet          Set-Culture                                        2.... 
Cmdlet          Set-Date                                           3.... 
Cmdlet          Set-DscLocalConfigurationManager                   1.1   
Cmdlet          Set-ExecutionPolicy                                3.... 
Cmdlet          Set-HVCIOptions                                    1.0   
Cmdlet          Set-IscsiServerTarget                              2.... 
Cmdlet          Set-IscsiTargetServerSetting                       2.... 
Cmdlet          Set-IscsiVirtualDisk                               2.... 
Cmdlet          Set-IscsiVirtualDiskSnapshot                       2.... 
Cmdlet          Set-Item                                           3.... 
Cmdlet          Set-ItemProperty                                   3.... 
Cmdlet          Set-JobTrigger                                     1.... 
Cmdlet          Set-KdsConfiguration                               1.... 
Cmdlet          Set-LapsADAuditing                                 1.... 
Cmdlet          Set-LapsADComputerSelfPermission                   1.... 
Cmdlet          Set-LapsADPasswordExpirationTime                   1.... 
Cmdlet          Set-LapsADReadPasswordPermission                   1.... 
Cmdlet          Set-LapsADResetPasswordPermission                  1.... 
Cmdlet          Set-LocalGroup                                     1.... 
Cmdlet          Set-LocalUser                                      1.... 
Cmdlet          Set-Location                                       3.... 
Cmdlet          Set-NfsMappedIdentity                              1.0   
Cmdlet          Set-NfsNetgroup                                    1.0   
Cmdlet          Set-NonRemovableAppsPolicy                         3.0   
Cmdlet          Set-PackageSource                                  1.... 
Cmdlet          Set-ProcessMitigation                              1.... 
Cmdlet          Set-PSBreakpoint                                   3....
Cmdlet          Set-PSDebug                                        3.... 
Cmdlet          Set-PSReadLineKeyHandler                           2.0.0 
Cmdlet          Set-PSReadLineOption                               2.0.0 
Cmdlet          Set-PSSessionConfiguration                         3.... 
Cmdlet          Set-RuleOption                                     1.0   
Cmdlet          Set-ScheduledJob                                   1.... 
Cmdlet          Set-ScheduledJobOption                             1.... 
Cmdlet          Set-SecureBootUEFI                                 2.... 
Cmdlet          Set-Service                                        3.... 
Cmdlet          Set-StrictMode                                     3.... 
Cmdlet          Set-TimeZone                                       3.... 
Cmdlet          Set-TpmOwnerAuth                                   2.... 
Cmdlet          Set-TraceSource                                    3.... 
Cmdlet          Set-Variable                                       3.... 
Cmdlet          Set-WheaMemoryPolicy                               2....
Cmdlet          Set-WinAcceptLanguageFromLanguageListOptOut        2.... 
Cmdlet          Set-WinCultureFromLanguageListOptOut               2.... 
Cmdlet          Set-WinDefaultInputMethodOverride                  2.... 
Cmdlet          Set-WindowsEdition                                 3.0   
Cmdlet          Set-WindowsProductKey                              3.0   
Cmdlet          Set-WindowsReservedStorageState                    3.0   
Cmdlet          Set-WinHomeLocation                                2.... 
Cmdlet          Set-WinLanguageBarOption                           2.... 
Cmdlet          Set-WinSystemLocale                                2.... 
Cmdlet          Set-WinUILanguageOverride                          2.... 
Cmdlet          Set-WinUserLanguageList                            2.... 
Cmdlet          Set-WmiInstance                                    3.... 
Cmdlet          Set-WSManInstance                                  3.... 
Cmdlet          Set-WSManQuickConfig                               3....
Cmdlet          Show-Command                                       3.... 
Cmdlet          Show-ControlPanelItem                              3.... 
Cmdlet          Show-EventLog                                      3.... 
Cmdlet          Sort-Object                                        3.... 
Cmdlet          Split-Path                                         3.... 
Cmdlet          Split-WindowsImage                                 3.0   
Cmdlet          Start-BitsTransfer                                 2.... 
Cmdlet          Start-DscConfiguration                             1.1   
Cmdlet          Start-DtcDiagnosticResourceManager                 1.... 
Cmdlet          Start-Job                                          3.... 
Cmdlet          Start-OSUninstall                                  3.0   
Cmdlet          Start-Process                                      3.... 
Cmdlet          Start-Service                                      3.... 
Cmdlet          Start-Sleep                                        3.... 
Cmdlet          Start-Transaction                                  3.... 
Cmdlet          Start-Transcript                                   3....
Cmdlet          Stop-Computer                                      3.... 
Cmdlet          Stop-DtcDiagnosticResourceManager                  1.... 
Cmdlet          Stop-IscsiVirtualDiskOperation                     2.... 
Cmdlet          Stop-Job                                           3.... 
Cmdlet          Stop-Process                                       3.... 
Cmdlet          Stop-Service                                       3.... 
Cmdlet          Stop-Transcript                                    3.... 
Cmdlet          Suspend-BitsTransfer                               2.... 
Cmdlet          Suspend-Job                                        3.... 
Cmdlet          Suspend-Service                                    3.... 
Cmdlet          Switch-Certificate                                 1.... 
Cmdlet          Tee-Object                                         3.... 
Cmdlet          Test-AppLockerPolicy                               2.... 
Cmdlet          Test-Certificate                                   1.... 
Cmdlet          Test-ComputerSecureChannel                         3.... 
Cmdlet          Test-Connection                                    3....
Cmdlet          Test-DscConfiguration                              1.1   
Cmdlet          Test-FileCatalog                                   3.... 
Cmdlet          Test-KdsRootKey                                    1.... 
Cmdlet          Test-ModuleManifest                                3.... 
Cmdlet          Test-NfsMappedIdentity                             1.0   
Cmdlet          Test-Path                                          3.... 
Cmdlet          Test-PSSessionConfigurationFile                    3.... 
Cmdlet          Test-WSMan                                         3.... 
Cmdlet          Trace-Command                                      3.... 
Cmdlet          Unblock-File                                       3.... 
Cmdlet          Unblock-Tpm                                        2.... 
Cmdlet          Undo-DtcDiagnosticTransaction                      1.... 
Cmdlet          Undo-Transaction                                   3.... 
Cmdlet          Uninstall-Package                                  1.... 
Cmdlet          Unprotect-CmsMessage                               3.... 
Cmdlet          Unregister-Event                                   3....
Cmdlet          Unregister-PackageSource                           1.... 
Cmdlet          Unregister-PSSessionConfiguration                  3.... 
Cmdlet          Unregister-ScheduledJob                            1.... 
Cmdlet          Update-FormatData                                  3.... 
Cmdlet          Update-Help                                        3.... 
Cmdlet          Update-LapsADSchema                                1.... 
Cmdlet          Update-List                                        3.... 
Cmdlet          Update-TypeData                                    3.... 
Cmdlet          Update-WIMBootEntry                                3.0   
Cmdlet          Use-Transaction                                    3.... 
Cmdlet          Use-WindowsUnattend                                3.0   
Cmdlet          Wait-Debugger                                      3.... 
Cmdlet          Wait-Event                                         3.... 
Cmdlet          Wait-Job                                           3.... 
Cmdlet          Wait-Process                                       3.... 
Cmdlet          Where-Object                                       3....
Cmdlet          Write-Debug                                        3.... 
Cmdlet          Write-Error                                        3.... 
Cmdlet          Write-EventLog                                     3.... 
Cmdlet          Write-Host                                         3.... 
Cmdlet          Write-Information                                  3.... 
Cmdlet          Write-Output                                       3.... 
Cmdlet          Write-Progress                                     3.... 
Cmdlet          Write-Verbose                                      3.... 
Cmdlet          Write-Warning                                      3.
```


### Get-Command function

```
Get_Command -CommandType "Function"

Function.       A:
...

Function        Update-MpSignature                                 1.0   
Function        Update-NetFirewallDynamicKeywordAddress            2.... 
Function        Update-NetIPsecRule                                2.... 
Function        Update-RDVirtualDesktopCollection                  2.... 
Function        Update-Script                                      1.... 
Function        Update-ScriptFileInfo                              1.... 
Function        Update-SmbMultichannelConnection                   2....
Function        Update-StorageBusCache                             1.... 
Function        Update-StorageFirmware                             2.... 
Function        Update-StoragePool                                 2.... 
Function        Update-StorageProviderCache                        2.... 
Function        V:
Function        W:
Function        Write-DtcTransactionsTraceSession                  1.... 
Function        Write-VolumeCache                                  2.... 
Function        X:
Function        Y:
Function        Z:

```


Get-Help

```
Get-Help Get-Date

get-help -examples

get-help About <topic name>
get-help <cmdlet name>
get-help <search term>

```

get-alias

```
CommandType     Name                                 Version   
-----------     ----                                  -----
Alias           % -> ForEach-Object
Alias           ? -> Where-Object
Alias           ac -> Add-Content
Alias           asnp -> Add-PSSnapin
Alias           cat -> Get-Content
Alias           cd -> Set-Location
Alias           CFS -> ConvertFrom-String                        
Alias           chdir -> Set-Location
Alias           clc -> Clear-Content
Alias           clear -> Clear-Host
Alias           clhy -> Clear-History
Alias           cli -> Clear-Item
Alias           clp -> Clear-ItemProperty
Alias           cls -> Clear-Host
Alias           clv -> Clear-Variable
Alias           cnsn -> Connect-PSSession
Alias           compare -> Compare-Object
Alias           copy -> Copy-Item
Alias           cp -> Copy-Item
Alias           cpi -> Copy-Item
Alias           cpp -> Copy-ItemProperty
Alias           curl -> Invoke-WebRequest
Alias           cvpa -> Convert-Path
Alias           dbp -> Disable-PSBreakpoint
Alias           del -> Remove-Item
Alias           diff -> Compare-Object
Alias           dir -> Get-ChildItem
Alias           dnsn -> Disconnect-PSSession
Alias           ebp -> Enable-PSBreakpoint
Alias           echo -> Write-Output
Alias           epal -> Export-Alias
Alias           epcsv -> Export-Csv
Alias           epsn -> Export-PSSession
Alias           erase -> Remove-Item
Alias           etsn -> Enter-PSSession
Alias           exsn -> Exit-PSSession
Alias           fc -> Format-Custom
Alias           fhx -> Format-Hex                                 
Alias           fl -> Format-List
Alias           foreach -> ForEach-Object
Alias           ft -> Format-Table
Alias           fw -> Format-Wide
Alias           gal -> Get-Alias
Alias           gbp -> Get-PSBreakpoint
Alias           gc -> Get-Content
Alias           gci -> Get-ChildItem
Alias           gcm -> Get-Command
Alias           gcs -> Get-PSCallStack
Alias           gdr -> Get-PSDrive
Alias           ghy -> Get-History
Alias           gi -> Get-Item
Alias           gjb -> Get-Job
Alias           gl -> Get-Location
Alias           gm -> Get-Member
Alias           gmo -> Get-Module
Alias           gp -> Get-ItemProperty
Alias           gps -> Get-Process
Alias           gpv -> Get-ItemPropertyValue
Alias           group -> Group-Object
Alias           gsn -> Get-PSSession
Alias           gsnp -> Get-PSSnapin
Alias           gsv -> Get-Service
Alias           gu -> Get-Unique
Alias           gv -> Get-Variable
Alias           gwmi -> Get-WmiObject
Alias           h -> Get-History
Alias           history -> Get-History
Alias           icm -> Invoke-Command
Alias           iex -> Invoke-Expression
Alias           ihy -> Invoke-History
Alias           ii -> Invoke-Item
Alias           ipal -> Import-Alias
Alias           ipcsv -> Import-Csv
Alias           ipmo -> Import-Module
Alias           ipsn -> Import-PSSession
Alias           irm -> Invoke-RestMethod
Alias           ise -> powershell_ise.exe
Alias           iwmi -> Invoke-WMIMethod
Alias           iwr -> Invoke-WebRequest
Alias           kill -> Stop-Process
Alias           lp -> Out-Printer
Alias           ls -> Get-ChildItem
Alias           man -> help
Alias           md -> mkdir
Alias           measure -> Measure-Object
Alias           mi -> Move-Item
Alias           mount -> New-PSDrive
Alias           move -> Move-Item
Alias           mp -> Move-ItemProperty
Alias           mv -> Move-Item
Alias           nal -> New-Alias
Alias           ndr -> New-PSDrive
Alias           ni -> New-Item
Alias           nmo -> New-Module
Alias           npssc -> New-PSSessionConfigurationFile
Alias           nsn -> New-PSSession
Alias           nv -> New-Variable
Alias           ogv -> Out-GridView
Alias           oh -> Out-Host
Alias           popd -> Pop-Location
Alias           ps -> Get-Process
Alias           pushd -> Push-Location
Alias           pwd -> Get-Location
Alias           r -> Invoke-History
Alias           rbp -> Remove-PSBreakpoint
Alias           rcjb -> Receive-Job
Alias           rcsn -> Receive-PSSession
Alias           rd -> Remove-Item
Alias           rdr -> Remove-PSDrive
Alias           ren -> Rename-Item
Alias           ri -> Remove-Item
Alias           rjb -> Remove-Job
Alias           rm -> Remove-Item
Alias           rmdir -> Remove-Item
Alias           rmo -> Remove-Module
Alias           rni -> Rename-Item
Alias           rnp -> Rename-ItemProperty
Alias           rp -> Remove-ItemProperty
Alias           rsn -> Remove-PSSession
Alias           rsnp -> Remove-PSSnapin
Alias           rujb -> Resume-Job
Alias           rv -> Remove-Variable
Alias           rvpa -> Resolve-Path
Alias           rwmi -> Remove-WMIObject
Alias           sajb -> Start-Job
Alias           sal -> Set-Alias
Alias           saps -> Start-Process
Alias           sasv -> Start-Service
Alias           sbp -> Set-PSBreakpoint
Alias           sc -> Set-Content
Alias           select -> Select-Object
Alias           set -> Set-Variable
Alias           shcm -> Show-Command
Alias           si -> Set-Item
Alias           sl -> Set-Location
Alias           sleep -> Start-Sleep
Alias           sls -> Select-String
Alias           sort -> Sort-Object
Alias           sp -> Set-ItemProperty
Alias           spjb -> Stop-Job
Alias           spps -> Stop-Process
Alias           spsv -> Stop-Service
Alias           start -> Start-Process
Alias           sujb -> Suspend-Job
Alias           sv -> Set-Variable
Alias           swmi -> Set-WMIInstance
Alias           tee -> Tee-Object
Alias           trcm -> Trace-Command
Alias           type -> Get-Content
Alias           wget -> Invoke-WebRequest
Alias           where -> Where-Object
Alias           wjb -> Wait-Job
Alias           write -> Write-Output

```


## find Cmdlets 

To search for modules (collections of cmdlets) in online repositories like the PowerShell Gallery, we can use `Find-Module`. Sometimes, if we don’t know the exact name of the module, it can be useful to search for modules with a similar name. We can achieve this by filtering the `Name` property and appending a wildcard (`*`) to the module’s partial name, using the following standard PowerShell 
syntax: `Cmdlet -Property "pattern"`. 
Once identified, the modules can be downloaded and installed from the repository with `Install-Module`, making new cmdlets contained in the module available for use.

```
Find-Module -verb Remove
Cmdlet -Property "remove"
Get-Command 

Get-Command -Verb Remove

Get-Command -Name Remove
```


## Navigating filesystem

```
dir 
Get-ChildItem        == ls      Get-ChildItem -Path C:\Users

Set-Location -Path ".\Documents"

New-Item -Path ".\captain-cabin\captain-wardrobe" -ItemType "Directory"

New-Item -Path ".\captain-cabin\captain-wardrobe\captain-boots.txt" -ItemType "File"

Remove-Item -Path ".\captain-cabin\captain-wardrobe\captain-boots.txt"
Remove-Item -Path ".\captain-cabin\captain-wardrobe"

Copy-Item -Path .\captain-cabin\captain-hat.txt -Destination .\captain-cabin\captain-hat2.txt

Get-ChildItem -Path ".\captain-cabin\"

Get-Content -Path ".\captain-hat.txt"

```

## piping, filtering, sorting


In PowerShell, piping is even more powerful because it passes **objects** rather than just text. These objects carry not only the data but also the properties and methods that describe and interact with the data.

```
# get a list of files in a directory and then sort them by size
Get-ChildItem | Sort-Object Length

-eq  equals
-ne  not equal
-gt  greater than
-ge  greater than or equal to
-lt  less than
-le  less than or equal to


# filter object by "extension" 
Get-ChildItem | Where-Object -Property "Extension" -eq ".txt"

# filter by matching  -like
Get-ChildItem | Where-Object -Property "Name" -like "ship*"

# filter object specifically/ limit
Get-ChildItem | Select-Object Name,Length

# filter based on strings (like grep)   regex capabilities
Select-String -Path ".\captain-hat.txt" -Pattern "hat"



Get-ChildItem | Where-Object -Property Length -gt 100
```



## system & network info 

PowerShell was created to address a growing need for a powerful automation and management tool to help system administrators and IT professionals.

```
Get-ComputerInfo

Get-LocalUser      accounts on the system

ipconfig

Get-NetIPConfiguration

Get-NetIPAddress


p1r4t3
A merry life and a short one
THM{p34rlInAsh3ll}
```


## system analysis

running processes, services, and active network connections

```
Get-Process

Get-Service      status of services on the machine: running,stopped,paused

# monitor active network connections (IR & malware analysis)
Get-NetTCPConnection

# generating file hashes
Get-FileHash -Path .\ship-flag.txt


71FC5EC11C2497A32F8F08E61399687D90ABE6E204D2964DF589543A613F3E08

OwningProcess

p1r4t3-s-compass

```


## scripting 

**Scripting** is the process of writing and executing a series of commands contained in a text file, known as a script, to automate tasks that one would generally perform manually in a shell

`Invoke-Command` is essential for executing commands on remote systems, making it fundamental for system administrators, security engineers and penetration testers.

```
Get-Help Invoke-Command -examples

Invoke-Command -FilePath c:\scripts\test.ps1 -ComputerName Server01

Invoke-Command -ComputerName Server01 -Credential Domain01\User01 -ScriptBlock { Get-Culture }



Invoke-Command -ComputerName RoyalFortune -ScriptBlock { Get-Service }
```






















